\input{../../preamble.sty}

\lhead{Линейная алгерба}
\cfoot{}
\rfoot{Лекция 8}

\begin{document}

\section*{Спектральная теорема для оператора общего вида}

%<*операторныеполиномы>
\begin{definition}
    Операторный полином $p\in \mathcal P_\infty [K]$ называется аннулирующим полиномом линейного оператора $\varphi$, если $p(\varphi)=0$
\end{definition}
\begin{remark}
    Множество аннулирующих полиномов операторов $\varphi$ --- ядро гомоморфизма $S_\varphi$ по определению.
\end{remark}

\begin{theorem}
    Аннулирующий полином существует.
\end{theorem}
\begin{proof}
    $\dim \mathcal P [\varphi] = n^2 \Rightarrow \exists n^2$ ЛНЗ элементов. Эти элементы : $\varphi, \varphi^2 \ldots \varphi^{n^2}$. Тогда $\{\mathcal I, \varphi, \varphi^2 \ldots \varphi^{n^2}\}$ --- ЛЗ
    $$\Rightarrow \exists p[\varphi] = \sum_{i=0}^{n^2} \alpha_i\varphi^i = 0 \Rightarrow \exists$$
\end{proof}

$] J_\varphi$ --- множество аннулирующих полиномов оператора $\varphi$
\begin{lemma}
    $J_\varphi$ --- идеал в $P_\infty [K]$
\end{lemma}
\begin{proof}
    $] p\in J_\varphi \Rightarrow p(\varphi)=0$

    $] q\in P_\infty[K]$

    $\sphericalangle p(\lambda)q(\lambda) \xrightarrow{S_\varphi} p(\varphi)q(\varphi)=0 \Rightarrow p(\lambda)q(\lambda)$ --- аннулирующий $\Rightarrow p(\lambda)q(\lambda)\in J_\varphi$
\end{proof}
\begin{definition}
    \textbf{Минимальным аннулирующим полиномом} оператора $\varphi$ называется мнимальнй полином $J_\varphi$
\end{definition}
\begin{remark}
    Обозначение минимального полинома: $p_\varphi(\lambda) \leftrightarrow p_\varphi(\varphi)=0$
\end{remark}

\begin{example}
    $] \varphi : X\to X$ --- оператор с простым спектром

    $] \chi_\varphi(\lambda)$ --- характеристический полином $\varphi \Rightarrow \chi_\varphi(\lambda)=p_\varphi(\lambda)$
\end{example}
\begin{proof}
    $$\varphi=\sum_{i=1}^n \lambda_i\mathcal P_i \Rightarrow \chi_\varphi(\varphi)=\sum_{i=1}^n \chi_\varphi(\lambda_i)\mathcal P_i=0$$
    Предположим обратное: $] p_\varphi(\lambda)$ --- минимальный полином, такой что $\deg p_\varphi < \deg \chi_\varphi$

    $] \chi_\varphi(\lambda)=(\lambda-\lambda_k)p_\varphi(\lambda)$

    $$\sphericalangle p_\varphi(\varphi)=\sum_{i=1}^n p_\varphi(\lambda_i)\mathcal P_i = p(\lambda_k)\mathcal P_k \Rightarrow p_\varphi(\varphi)\not=0 \Rightarrow \text{противоречие}$$
\end{proof}

\begin{lemma}
    $] p(\varphi)=q(\varphi) \Leftrightarrow [p(\lambda)-q(\lambda)] \mid p_\varphi(\lambda)$
\end{lemma}
\begin{proof}
    $\sphericalangle p(\lambda)-q(\lambda)=0 \Rightarrow p(\lambda)-q(\lambda)\in J_\varphi$
\end{proof}

\begin{lemma}
    $] p(\lambda)=q(\lambda)p_\varphi(\lambda)+r(\lambda) \Rightarrow p(\varphi)=r(\varphi)$
\end{lemma}
%</операторныеполиномы>

%<*44>
\begin{theorem}
    $\sphericalangle p_\varphi=p_1\ldots p_k$, $p_1\ldots p_k$ --- взаимно простые
    $$\Rightarrow \dot+\sum_{j=1}^k \ker p_j(\varphi)=X$$
\end{theorem}
\begin{proof}
    $$\ker p_\varphi(\varphi)=\dot+\sum_{j=1}^k \ker p_j(\varphi)$$
    $$\ker p_\varphi(\varphi)=\ker 0 = X$$
\end{proof}
\begin{theorem}
    О ядре и образе.

    $] p_\varphi(\lambda)=p_1(\lambda)p_2(\lambda) \Rightarrow \ker p_1(\varphi)=\im p_2(\varphi)$
\end{theorem}
\begin{proof}
    Покажем, что:
    \begin{enumerate}
        \item $\im p_2(\varphi)\subset \ker p_1(\varphi)$
        \item $\dim \im p_2(\varphi)=\dim \ker p_1(\varphi)$
    \end{enumerate}

    \begin{enumerate}
        \item $\im p_2(\varphi)\subset \ker p_1(\varphi)$
        
        $] y \in \im p_2(\varphi) \Rightarrow \exists x\in X : y=p_2(\varphi) x$

        $\sphericalangle p_1(\varphi) y = p_1(\varphi)p_2(\varphi) x = p_\varphi(\varphi) = 0$

        \item $\ker p_\varphi(\varphi) = \ker p_1(\varphi) \dot+ \ker p_2(\varphi) \Rightarrow$
        $$\dim X = \dim \ker p_1(\varphi) + \dim \ker p_2(\varphi)$$
        $$\dim X = \dim \ker p_2(\varphi) + \dim \im p_2(\varphi)$$
        $$\dim \ker p_1(\varphi)=\dim \im p_2(\varphi)$$
    \end{enumerate}
\end{proof}

\begin{theorem}
    $] p_\varphi(\lambda) = \prod\limits_{i=1}^k p_i(\lambda)$ --- минимальный аннулирующий полином $\varphi$, $p_1\ldots p_k$ --- взаимно простые делители

    $\Rightarrow$
    \begin{enumerate}
        \item $\sum\limits_{j=1}^k p_j'(\varphi)q_j(\varphi)=\mathcal I, \quad p_j'=\frac{p_\varphi}{p_j}$
        \item $p_j'(\varphi)q_j(\varphi)=\mathcal P_{L_j} \quad L_j=\ker p_j(\varphi)$
    \end{enumerate}
\end{theorem}
\begin{proof}
    $\sphericalangle p_\varphi(\lambda) = p_1(\lambda)p_2(\lambda)\ldots p_k(\lambda) \quad \exists q_1\ldots q_k :$
    $$\sum_{j=1}^k p_j'(\lambda)q_j(\lambda)=1 \xrightarrow{S_\varphi} \sum_{j=1}^n p_j'(\varphi)q_j(\varphi)=\mathcal I$$
    $] p_1(\lambda)=p_i(\lambda), p_2(\lambda)=p_i'(\lambda) \Rightarrow \im p_1(\varphi) = \ker p_2(\varphi)$

    $\sphericalangle \mathcal P_{L_1} x = p_i'(\varphi)q(\varphi) \in \ker p_i(\varphi)$, т.к.
    $$p_i(\varphi)[p_i'(\varphi)q_i(\varphi) x]=p_i(\varphi)p_i'(\varphi)q_i(\varphi)x=p_\varphi(\varphi)q_i(\varphi)x=0$$

    Осталось доказать, что $\mathcal P_{L_i}\mathcal P_{L_j}=\delta_i^j \mathcal P_{L_i}$

    $$] i\not=j \Rightarrow \mathcal P_{L_i}\mathcal P_{L_j}=p_i'(\varphi)q_i(\varphi)p_j'(\varphi)q_j(\varphi)=\frac{p_\varphi(\varphi)}{p_i(\varphi)p_j(\varphi)}q_i(\varphi)q_j(\varphi)p_\varphi(\varphi)=0$$
    $$] i = j \Rightarrow \mathcal P_{L_i} (x) = \mathcal P_{L_i} (\mathcal I \cdot x)=\mathcal P_{L_i} \left(\sum_{j=1}^n \mathcal P_{L_j}\right) x=\mathcal P_{L_i}\mathcal P_{L_i} x \quad \forall x$$
    $$\Rightarrow \mathcal P_{L_i}\mathcal P_{L_i}=\mathcal P_{L_i}$$
\end{proof}
%</44>

\section*{Ультраинвариантные подпространства}

%<*ультраинваринтноепространство>
$\sphericalangle \varphi : X\to X, \dim X = n$

$L\subset X$ --- инвариантное подпространство $\varphi$, если $\varphi(L)\subset L$

\begin{definition}
    Инвариантное подпространство называется \textbf{ультраинвариантным подпространством}, если существует его дополнение $L'$, такое что:
    $$L\dot + L'=X \quad L' \text{ --- инвариантное подпространство }\varphi$$
\end{definition}

\begin{definition}
    Оператор $\varphi_L : L\to L$, такой что:
    $$\varphi_L x =\varphi x \quad \forall x\in L$$
    называется \textbf{сужением} оператора $\varphi$ на $L$.

    Если $L$ --- ультраинвариантное подпространство, то $\varphi_L$ называется \textbf{компонетной} $\varphi$ в $L$ 
\end{definition}

\begin{lemma}
    Дополнение $L'$ ультраинвариантного подпространства $L$ является ультраинвариантным подпространством.
\end{lemma}
\begin{lemma}
    $X = L \dot+ L' \quad L,L'$ --- ультраинвариантное подпространства $\Rightarrow$
    $$\varphi = \varphi_L \mathcal P_L^{\parallel L'} + \varphi_{L'} \mathcal P_{L'}^{\parallel L}$$
\end{lemma}
\begin{proof}
    $$X = L \dot+ L' \Rightarrow \forall x! = x_1+x_2 = \mathcal P_L^{\parallel L'} x + \mathcal P_{L'}^{\parallel L} x$$
    $$\varphi x = \varphi \mathcal P_L^{\parallel L'} x + \varphi \mathcal P_{L'}^{\parallel L} x \quad \forall x \quad \Rightarrow$$
    $$\Rightarrow \varphi=\varphi_L \mathcal P_L^{\parallel L'} + \varphi_{L'} \mathcal P_{L'}^{\parallel L} \quad (*)$$
\end{proof}
%</ультраинваринтноепространство>

\begin{remark}
    Запись $(*)$ эквивалентна записи
    $$\varphi = \varphi_L \dot+ \varphi_{L'}$$
\end{remark}

\begin{definition}
    Инвариантное подпространство называется \textbf{минимальным}, если оно не содержит внутри себя нетривиальных инвариантных подпространств меньшей размерности.
\end{definition}

\begin{lemma}
    $] \varphi : X \to X$ --- линейный оператор $\Rightarrow \ker p(\varphi)$ --- инвариантное подпространство $\varphi$
\end{lemma}
\begin{proof}
    $] x\in \ker p(\varphi) \Rightarrow p(\varphi) x = 0$

    $\sphericalangle \varphi : p(\varphi)(\varphi x) = \varphi p(\varphi) x = 0$
\end{proof}

\begin{lemma}
    $] p_\varphi(\lambda)=p_1(\lambda)p_2(\lambda)$ --- минимальный полином $\varphi \Rightarrow \ker p_i(\varphi)$ --- нетривиальное инвариантное подпространство $\varphi$
\end{lemma}
\begin{proof}
    $$] p_1(\lambda) : \ker p_1(\varphi) = X, \deg p_1(\lambda) < \deg p_\varphi(\lambda) \Rightarrow p_1(\varphi)\stackrel{def}{=}0 \Rightarrow p_1(\lambda)\in J_\varphi, \deg p_1(\lambda)\subset \deg p_\varphi(\lambda)$$
    Это противоречит определению минимального полинома $p_\varphi$. Аналогично для $p_2$.

    $$] p_1(\lambda) : \ker p_1(\varphi) = 0 \Rightarrow x = \ker p_1(\varphi)\dot+\ker p_2(\varphi) \quad \dim p_1 (\varphi) = 0 \Rightarrow \ker p_2(\varphi) =x$$
    Это чему-то противоречит.

    Итого $p_i(\varphi)\not=0$ и $p_i(\varphi)\not=X \Rightarrow \ker p_i(\varphi)$  --- нетривиальное подпространство.
\end{proof}

\begin{remark}
    $\ker p_1(\varphi)$ --- ИП, $\ker p_2(\varphi)$ --- ИП, $\ker p_1(\varphi)\dot+\ker p_2(\varphi) \Rightarrow p_1, p_2$ --- ультраинвариантные подпространства
\end{remark}

\begin{theorem}
    Обобщение.

    $p_\varphi(\lambda)=p_1(\lambda)\ldots p_k(\lambda)$ --- взаимно простые
    $$X = \dot + \sum_{j=1}^k \ker p_j(\varphi) = \dot+\sum_{j=1}^n L_j$$
    , где $L_j = \ker p_j (\varphi)$ --- ультраинвариантные подпространства.
\end{theorem}
\begin{proof}
    Тривиально.
\end{proof}

$\mathcal P_j = \mathcal P_{L_j} = p_j'(\varphi) q_j$ --- проектора на ультраинвариантное подпространство $L_j$ \textit{(ультрапроектор)}

$\sphericalangle \varphi_j = \varphi / L_j : L_j\to L_J$ --- компонента $\varphi$ в ультраинвариантном подпространстве $L_j$
$$\varphi=\dot+\sum_{j=1}^k \varphi_j = \sum_{j=1}^k \varphi_j \mathcal P_j$$

\begin{lemma}
    $] p_\varphi=p_1\ldots p_k$ --- минимальный аннулирующий полином $\varphi$

    $\Rightarrow p_j(\lambda)$ --- минимальный аннулирующий полином $\varphi_j$
\end{lemma}
\begin{proof}
    $\varphi_j : L_j \rightarrow L_j , L_j=\ker p_j(\varphi)$

    $] x\in\ker p_j(\varphi) \quad p_j(\varphi) x = 0 \ \ \forall x\in L_j \Rightarrow p_j\in I_{\varphi_j}$

    $] \tilde p_j(\lambda)$ --- минимальный полином $I_{\varphi_j}$
    $$p_j(\lambda)=q_j(\lambda)\tilde p_j(\lambda)$$
    $$\sphericalangle p_\varphi(\lambda)=p_1(\lambda)p_2(\lambda)\ldots p_j(\lambda)\ldots p_k(\lambda)=p_1(\lambda)p_2(\lambda)\ldots \tilde p_j(\lambda)\ldots p_k(\lambda)q_j(\lambda)=\tilde p_\varphi(\lambda)q(\lambda)$$
    $\Rightarrow \deg p_\varphi(\lambda) > \deg \tilde p_\varphi(\lambda)$, но $p_\varphi(\lambda)$ --- минимальный --- противоречие.
\end{proof}

%<*спектральнаятеорема>
\begin{theorem}
    Спектральная теорема.
    $$p_\varphi(\lambda)=\prod_{j=1}^k (\lambda-\lambda_j)^{m_j}=p_1(\lambda)\ldots p_k(\lambda) \quad p_j(\lambda)=(\lambda-\lambda_j)^{m_j}, \lambda\not=\lambda_{i\not=j}$$
    $$\Rightarrow L_j=\ker p_j(\varphi)=\ker(\varphi-\lambda_j\mathcal I)^{m_j} \text{ --- ультраинвариантное подпространство}$$
    $$\Rightarrow X = \dot+ \sum_{j=1}^n \ker (\varphi-\lambda_j\mathcal I)^{m_j}=\dot+\sum_{j=1}^k L_j$$
    $$\varphi = \dot+\sum_{j=1}^k \varphi_j \quad \varphi_j = \varphi|_{L_j}$$
\end{theorem}
%</спектральнаятеорема>

% $$\sphericalangle L_j = \ker (\varphi_j - \lambda_j \mathcal I)^{m_j} \quad p_j(\lambda)=(\lambda-\lambda_j)^{m_j} - \min$$

\begin{definition}
    \textbf{Нильпотентным оператором} порядка $m$ называется минимальный оператор $\tau$, такой что:
    $$\tau^m=0 \quad \forall k<m \ \ \tau^k\not=0$$
\end{definition}
\begin{remark}
    $(\varphi_j - \lambda_j \mathcal I)=\tau_j$ --- нильпотентный оператор порядка $m_j$
\end{remark}

$\varphi=\sum\limits_{j=1}^K (\lambda_j \mathcal I + \tau_j)\mathcal P_j$ --- спектральная теорема \textit{(другая формулировка)}.

\begin{definition}
    \begin{itemize}
        \item $\lambda_j$ --- элементарная порция спектра
        \item $\mathcal P_j$ --- спектральный ультрапроектор на $L_j$
        \item $L_j$ --- спектральное ультраинвариантное \textit{(корневое)} подпространство
        \item $\varphi_j$ --- спектральная компонента оператора $\varphi$ в инвариантном подпространстве $L_j$
    \end{itemize}
\end{definition}

\end{document}